const translations = {
    en: {
        meta_title: "Face Mosaic Pro - AI Video Privacy",
        nav_home: "Home",
        nav_privacy: "Privacy",
        nav_terms: "Terms",
        nav_support: "Support",
        hero_title: "Protect Identity in Videos with AI",
        hero_desc: "Automatically detect faces and apply mosaic, blur, or stickers. Processing is done entirely on-device for maximum privacy.",
        download_ios: "Download on App Store",
        download_android: "Get it on Google Play",
        feature_1_title: "AI Face Detection",
        feature_1_desc: "High-precision face detection tracks movement automatically.",
        feature_2_title: "On-Device Privacy",
        feature_2_desc: "Your videos never leave your phone. 100% secure.",
        feature_3_title: "Creative Effects",
        feature_3_desc: "Choose from Pixelate, Blur, Blackout, or Stickers.",
        privacy_title: "Privacy Policy",
        privacy_content_1: "At Face Mosaic Pro, we prioritize your privacy above all else.",
        privacy_content_2: "1. No Data Collection: We do not collect, store, or transmit your video data to any server. All processing happens locally on your device.",
        privacy_content_3: "2. Face Data: Face detection is performed using on-device APIs and is transient. No face data is stored.",
        terms_title: "Terms of Service",
        terms_content_1: "By using Face Mosaic Pro, you agree to these terms.",
        terms_content_2: "1. License: We grant you a revocable, non-exclusive license to use the app for personal use.",
        terms_content_3: "2. Prohibited Use: You may not use this app for illegal activities.",
        support_title: "Support",
        support_desc: "Have questions or found a bug? Reach out to us.",
        contact_btn: "Contact Us via Email",
        footer_rights: "Â© 2024 Face Mosaic Pro. All rights reserved."
    },
    ja: {
        meta_title: "Face Mosaic Pro - AIå‹•ç”»ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ä¿è­·",
        nav_home: "ãƒ›ãƒ¼ãƒ ",
        nav_privacy: "ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼",
        nav_terms: "åˆ©ç”¨è¦ç´„",
        nav_support: "ã‚µãƒãƒ¼ãƒˆ",
        hero_title: "AIã§å‹•ç”»ã®è‚–åƒæ¨©ã‚’å®ˆã‚‹",
        hero_desc: "é¡”ã‚’è‡ªå‹•æ¤œå‡ºã—ã€ãƒ¢ã‚¶ã‚¤ã‚¯ã€ã¼ã‹ã—ã€ã‚¹ã‚¿ãƒ³ãƒ—ã‚’é©ç”¨ã€‚ã™ã¹ã¦ã®å‡¦ç†ã¯ç«¯æœ«å†…ã§è¡Œã‚ã‚Œã‚‹ãŸã‚ã€ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã¯å®Œå…¨ã«å®ˆã‚‰ã‚Œã¾ã™ã€‚",
        download_ios: "App Storeã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰",
        download_android: "Google Playã§æ‰‹ã«å…¥ã‚Œã‚‹",
        feature_1_title: "AIé¡”æ¤œå‡º",
        feature_1_desc: "é«˜ç²¾åº¦ãªAIãŒå‹•ãã«åˆã‚ã›ã¦é¡”ã‚’è‡ªå‹•è¿½å°¾ã—ã¾ã™ã€‚",
        feature_2_title: "å®Œå…¨ãƒ­ãƒ¼ã‚«ãƒ«å‡¦ç†",
        feature_2_desc: "å‹•ç”»ãŒå¤–éƒ¨ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã•ã‚Œã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚",
        feature_3_title: "å¤šå½©ãªã‚¨ãƒ•ã‚§ã‚¯ãƒˆ",
        feature_3_desc: "ãƒ”ã‚¯ã‚»ãƒ«ã€ã¼ã‹ã—ã€é»’å¡—ã‚Šã€ã‚¹ã‚¿ãƒ³ãƒ—ã‹ã‚‰é¸æŠžå¯èƒ½ã€‚",
        privacy_title: "ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼",
        privacy_content_1: "Face Mosaic Proã§ã¯ã€ãŠå®¢æ§˜ã®ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã‚’æœ€å„ªå…ˆã—ã¦ã„ã¾ã™ã€‚",
        privacy_content_2: "1. ãƒ‡ãƒ¼ã‚¿åŽé›†ãªã—: å‹•ç”»ãƒ‡ãƒ¼ã‚¿ã®åŽé›†ã€ä¿å­˜ã€é€ä¿¡ã¯ä¸€åˆ‡è¡Œã„ã¾ã›ã‚“ã€‚ã™ã¹ã¦ç«¯æœ«å†…ã§å‡¦ç†ã•ã‚Œã¾ã™ã€‚",
        privacy_content_3: "2. é¡”ãƒ‡ãƒ¼ã‚¿: é¡”æ¤œå‡ºã¯ã‚ªãƒ³ãƒ‡ãƒã‚¤ã‚¹APIã‚’ä½¿ç”¨ã—ã€ä¸€æ™‚çš„ãªã‚‚ã®ã§ã™ã€‚é¡”ãƒ‡ãƒ¼ã‚¿ã¯ä¿å­˜ã•ã‚Œã¾ã›ã‚“ã€‚",
        terms_title: "åˆ©ç”¨è¦ç´„",
        terms_content_1: "ã‚¢ãƒ—ãƒªã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ä»¥ä¸‹ã®è¦ç´„ã«åŒæ„ã—ãŸã‚‚ã®ã¨ã¿ãªã•ã‚Œã¾ã™ã€‚",
        terms_content_2: "1. ãƒ©ã‚¤ã‚»ãƒ³ã‚¹: å€‹äººçš„ãªä½¿ç”¨ã«é™ã‚Šã€æœ¬ã‚¢ãƒ—ãƒªã®ä½¿ç”¨ã‚’è¨±è«¾ã—ã¾ã™ã€‚",
        terms_content_3: "2. ç¦æ­¢äº‹é …: é•æ³•è¡Œç‚ºã®ãŸã‚ã«æœ¬ã‚¢ãƒ—ãƒªã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚",
        support_title: "ã‚µãƒãƒ¼ãƒˆ",
        support_desc: "ã”è³ªå•ã‚„ãƒã‚°ã®å ±å‘Šã¯ã“ã¡ã‚‰ã‹ã‚‰ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚",
        contact_btn: "ãƒ¡ãƒ¼ãƒ«ã§å•ã„åˆã‚ã›ã‚‹",
        footer_rights: "Â© 2024 Face Mosaic Pro. All rights reserved."
    },
    es: {
        meta_title: "Face Mosaic Pro - Privacidad de Video AI",
        nav_home: "Inicio",
        nav_privacy: "Privacidad",
        nav_terms: "TÃ©rminos",
        nav_support: "Soporte",
        hero_title: "Proteja la identidad en videos con IA",
        hero_desc: "Detecta rostros automÃ¡ticamente y aplica mosaico o desenfoque. El procesamiento se realiza completamente en el dispositivo.",
        download_ios: "Descargar en App Store",
        download_android: "ConsÃ­guelo en Google Play",
        feature_1_title: "DetecciÃ³n de Rostros IA",
        feature_1_desc: "DetecciÃ³n de alta precisiÃ³n que sigue el movimiento automÃ¡ticamente.",
        feature_2_title: "Privacidad en el Dispositivo",
        feature_2_desc: "Tus videos nunca salen de tu telÃ©fono. 100% seguro.",
        feature_3_title: "Efectos Creativos",
        feature_3_desc: "Elige entre Pixelar, Desenfocar, Censura o Pegatinas.",
        privacy_title: "PolÃ­tica de Privacidad",
        privacy_content_1: "En Face Mosaic Pro, priorizamos su privacidad.",
        privacy_content_2: "1. Sin recopilaciÃ³n de datos: No recopilamos ni transmitimos sus videos. Todo ocurre localmente.",
        privacy_content_3: "2. Datos faciales: La detecciÃ³n es transitoria y no se almacena ningÃºn dato facial.",
        terms_title: "TÃ©rminos de Servicio",
        terms_content_1: "Al usar Face Mosaic Pro, acepta estos tÃ©rminos.",
        terms_content_2: "1. Licencia: Le otorgamos una licencia para uso personal.",
        terms_content_3: "2. Uso prohibido: No puede usar esta aplicaciÃ³n para actividades ilegales.",
        support_title: "Soporte",
        support_desc: "Â¿Tiene preguntas? ContÃ¡ctenos.",
        contact_btn: "ContÃ¡ctenos por correo",
        footer_rights: "Â© 2024 Face Mosaic Pro. Todos los derechos reservados."
    },
    // ä»–ã®è¨€èªž (zh, hi, ar, pt, ru, ko, fr) ã‚‚åŒæ§˜ã®æ§‹é€ ã§è¿½åŠ å¯èƒ½
    // ç°¡ç•¥åŒ–ã®ãŸã‚ã€ä¸»è¦è¨€èªžä»¥å¤–ã¯è‹±èªžã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã•ã›ã¾ã™
};

const supportedLanguages = [
    { code: 'en', name: 'English', flag: 'ðŸ‡ºðŸ‡¸' },
    { code: 'ja', name: 'æ—¥æœ¬èªž', flag: 'ðŸ‡¯ðŸ‡µ' },
    { code: 'es', name: 'EspaÃ±ol', flag: 'ðŸ‡ªðŸ‡¸' },
    { code: 'zh', name: 'ä¸­æ–‡', flag: 'ðŸ‡¨ðŸ‡³' },
    { code: 'hi', name: 'à¤¹à¤¿à¤¨à¥à¤¦à¥€', flag: 'ðŸ‡®ðŸ‡³' },
    { code: 'ar', name: 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©', flag: 'ðŸ‡¦ðŸ‡ª' },
    { code: 'pt', name: 'PortuguÃªs', flag: 'ðŸ‡§ðŸ‡·' },
    { code: 'ru', name: 'Ð ÑƒÑÑÐºÐ¸Ð¹', flag: 'ðŸ‡·ðŸ‡º' },
    { code: 'ko', name: 'í•œêµ­ì–´', flag: 'ðŸ‡°ðŸ‡·' },
    { code: 'fr', name: 'FranÃ§ais', flag: 'ðŸ‡«ðŸ‡·' }
];

document.addEventListener('DOMContentLoaded', () => {
    // 1. URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰è¨€èªžã‚’å–å¾—
    const urlParams = new URLSearchParams(window.location.search);
    let currentLang = urlParams.get('lang') || navigator.language.slice(0, 2);
    
    // ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„è¨€èªžãªã‚‰è‹±èªžã«ã™ã‚‹
    if (!translations[currentLang] && !['en', 'ja', 'es'].includes(currentLang)) {
        // ãƒ‡ãƒ¢ç”¨ã¨ã—ã¦ã€æœªå®šç¾©è¨€èªžã¯è‹±èªžã‚’è¡¨ç¤ºã—ã¤ã¤ã€è¨€èªžã‚³ãƒ¼ãƒ‰ã ã‘ç¶­æŒã™ã‚‹ï¼ˆã¾ãŸã¯enã«ã™ã‚‹ï¼‰
        // ã“ã“ã§ã¯ç°¡æ˜“çš„ã«ç¿»è¨³ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚‹ã‚‚ã®ã ã‘å‡¦ç†ã—ã€ãªã‘ã‚Œã°è‹±èªž
        if (!translations[currentLang]) currentLang = 'en'; 
    }
    // ä¸Šè¨˜ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ãªã„è¨€èªžã‚³ãƒ¼ãƒ‰ãŒæ¥ãŸå ´åˆã®ãŸã‚ã«è‹±èªžãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
    const langData = translations[currentLang] || translations['en'];

    // 2. ãƒ†ã‚­ã‚¹ãƒˆã®ç½®æ›
    document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (langData[key]) {
            el.textContent = langData[key];
        }
    });

    // 3. RTL (å³æ›¸ã) å¯¾å¿œ
    if (['ar', 'he'].includes(currentLang)) {
        document.documentElement.setAttribute('dir', 'rtl');
        document.body.classList.add('rtl');
    } else {
        document.documentElement.setAttribute('dir', 'ltr');
        document.body.classList.remove('rtl');
    }

    // 4. è¨€èªžã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ã®ç”Ÿæˆ
    const selector = document.getElementById('language-selector');
    if (selector) {
        supportedLanguages.forEach(lang => {
            const option = document.createElement('option');
            option.value = lang.code;
            option.textContent = `${lang.flag} ${lang.name}`;
            if (lang.code === currentLang) option.selected = true;
            selector.appendChild(option);
        });

        selector.addEventListener('change', (e) => {
            const newLang = e.target.value;
            const url = new URL(window.location);
            url.searchParams.set('lang', newLang);
            window.location.href = url.toString();
        });
    }

    // 5. ãƒªãƒ³ã‚¯ã®ç¶­æŒ (ä»–ã®ãƒšãƒ¼ã‚¸ã¸ã®é·ç§»æ™‚ã« lang ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å¼•ãç¶™ã)
    document.querySelectorAll('a').forEach(link => {
        // å¤–éƒ¨ãƒªãƒ³ã‚¯ã‚„ã‚¢ãƒ³ã‚«ãƒ¼ãƒªãƒ³ã‚¯ã¯é™¤å¤–
        const href = link.getAttribute('href');
        if (href && !href.startsWith('http') && !href.startsWith('#') && !href.startsWith('mailto')) {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetUrl = new URL(href, window.location.origin);
                targetUrl.searchParams.set('lang', currentLang);
                window.location.href = targetUrl.toString();
            });
        }
    });
});
